<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Математика — это искусство</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <canvas id="bg"></canvas>
  <section class="hero">
    <h1>Математика —<br>это искусство</h1>
    <p class="subtitle">Кликни на карточку — оживи формулу</p>
  </section>
  <div id="content"></div>
  <script>
// bg-canvas.js — кометы с хвостами, но без грязи на фоне навсегда

const canvas = document.getElementById('bg');
if (!canvas) throw new Error('#bg не найден');

const ctx = canvas.getContext('2d');
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

window.addEventListener('resize', () => {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
});

const comets = [];

class Comet {
  constructor() {
    this.reset();
    this.trail = []; // массив точек хвоста
  }

  reset() {
    const side = Math.floor(Math.random() * 4);
    if (side === 0) { this.x = Math.random() * w; this.y = -50; }
    else if (side === 1) { this.x = w + 50; this.y = Math.random() * h; }
    else if (side === 2) { this.x = Math.random() * w; this.y = h + 50; }
    else { this.x = -50; this.y = Math.random() * h; }

    const angle = Math.random() * Math.PI * 2;
    const speed = 2.5 + Math.random() * 3;
    this.vx = Math.cos(angle) * speed;
    this.vy = Math.sin(angle) * speed;

    this.size = 2 + Math.random() * 2;
    this.color = Math.random() > 0.5 ? '#00ff9d' : '#00f0ff';
    this.trail = [];
  }

  update() {
    // Добавляем текущую позицию в хвост
    this.trail.push({ x: this.x, y: this.y });
    if (this.trail.length > 25) this.trail.shift(); // длина хвоста

    this.x += this.vx;
    this.y += this.vy;

    // Если улетела — новая комета
    if (this.x < -100 || this.x > w + 100 || this.y < -100 || this.y > h + 100) {
      this.reset();
    }
  }

  draw() {
    // Рисуем хвост
    ctx.lineWidth = 3;
    ctx.shadowBlur = 15;
    ctx.shadowColor = this.color;
    
    for (let i = 0; i < this.trail.length; i++) {
      const alpha = i / this.trail.length;
      ctx.globalAlpha = alpha * 0.8;
      ctx.strokeStyle = this.color;
      ctx.beginPath();
      if (i === 0) {
        ctx.moveTo(this.trail[i].x, this.trail[i].y);
      } else {
        ctx.moveTo(this.trail[i - 1].x, this.trail[i - 1].y);
        ctx.lineTo(this.trail[i].x, this.trail[i].y);
      }
      ctx.stroke();
    }

    // Голова кометы
    ctx.globalAlpha = 1;
    ctx.fillStyle = '#ffffff';
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size + 1.5, 0, Math.PI * 2);
    ctx.fill();

    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

// 8–10 комет
for (let i = 0; i < 10; i++) {
  comets.push(new Comet());
}

function animate() {
  // ПОЛНАЯ ОЧИСТКА — никаких следов навсегда
  ctx.clearRect(0, 0, w, h);

  comets.forEach(c => {
    c.update();
    c.draw();
  });

  ctx.shadowBlur = 0;
  requestAnimationFrame(animate);
}

animate();
  </script>
  <script src="script.js"></script>
</body>
</html>